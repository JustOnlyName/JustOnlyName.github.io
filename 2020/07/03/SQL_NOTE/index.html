<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 4.2.1">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/font-awesome.min.css">

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"justonlyname.github.io","root":"/","scheme":"Gemini","version":"7.8.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":false,"show_result":false,"style":null},"back2top":{"enable":true,"sidebar":false,"scrollpercent":false},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":false,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}}};
  </script>

  <meta name="description" content="SQL语句 &amp;emsp;作为一名各种方面赤果果的新手，在计算机……遇到很多问题，姑且先记录下来，这个小本er本er以便为日后翻翻看看。同样那句话，好记性不如烂键盘膜。">
<meta property="og:type" content="article">
<meta property="og:title" content="SQL_NOTE">
<meta property="og:url" content="https://justonlyname.github.io/2020/07/03/SQL_NOTE/index.html">
<meta property="og:site_name" content="Hexo">
<meta property="og:description" content="SQL语句 &amp;emsp;作为一名各种方面赤果果的新手，在计算机……遇到很多问题，姑且先记录下来，这个小本er本er以便为日后翻翻看看。同样那句话，好记性不如烂键盘膜。">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="https://i.loli.net/2019/09/11/deFkvLIuGNqOnVa.jpg">
<meta property="og:image" content="https://i.loli.net/2019/09/19/b9nh3kDXq5JwmRs.jpg">
<meta property="article:published_time" content="2020-07-03T06:19:27.000Z">
<meta property="article:modified_time" content="2020-07-17T15:31:46.998Z">
<meta property="article:author" content="John Doe">
<meta property="article:tag" content="MySQL">
<meta property="article:tag" content="sql">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://i.loli.net/2019/09/11/deFkvLIuGNqOnVa.jpg">

<link rel="canonical" href="https://justonlyname.github.io/2020/07/03/SQL_NOTE/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : false,
    isPost : true,
    lang   : 'en'
  };
</script>

  <title>SQL_NOTE | Hexo</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="Toggle navigation bar">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">Hexo</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-fw fa-home"></i>Home</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-fw fa-archive"></i>Archives</a>

  </li>
  </ul>
</nav>




</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content post posts-expand">
            

    
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="https://justonlyname.github.io/2020/07/03/SQL_NOTE/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="John Doe">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Hexo">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          SQL_NOTE
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2020-07-03 14:19:27" itemprop="dateCreated datePublished" datetime="2020-07-03T14:19:27+08:00">2020-07-03</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2020-07-17 23:31:46" itemprop="dateModified" datetime="2020-07-17T23:31:46+08:00">2020-07-17</time>
              </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
        <h1 id="SQL语句"><a href="#SQL语句" class="headerlink" title="SQL语句"></a>SQL语句</h1><blockquote>
<p>&emsp;作为一名各种方面赤果果的新手，在计算机……遇到很多问题，姑且先记录下来，这个小本er本er以便为日后翻翻看看。同样那句话，好记性不如烂键盘膜。</p>
</blockquote>
<a id="more"></a>

<p>&emsp;用typora排版挺好看，部署到博客上tab缩进无效果，排版错乱，目前没找到什么解决tab这个问题的方法，有个<code>&amp;emsp;</code>但太麻烦，先就这样浏览吧</p>
<h2 id="MySQL数据库"><a href="#MySQL数据库" class="headerlink" title="MySQL数据库"></a>MySQL数据库</h2><blockquote>
<p>&emsp;关系型数据库管理系统，体积小、速度快、总体成本低，开放源代码<br>&emsp;与大型规模的数据库（Oracle）相比有不足<br>&emsp;对用户最遗憾的是没有图形用户界面，需使用命令行管理MySQL数据库</p>
</blockquote>
<h3 id="基本命令行使用命令"><a href="#基本命令行使用命令" class="headerlink" title="基本命令行使用命令"></a>基本命令行使用命令</h3><ol>
<li><p>进行必要的安全初始化</p>
<p>命令行进入<MySQL-installpath>/bin 目录，执行<code>mysqld --initialize-insecure</code>·</p>
<p>目的是初始化data目录，并授权一个无密码的root用户</p>
</li>
<li><p>启动MySQL数据库服务器</p>
</li>
</ol>
<blockquote>
<p>初始化后，命令行输入<code>mysqld</code>或<code>mysqld -nt</code><br>mysqld   //cmd 命令行中启动MySQL<br>mysql -u root  -p   //连接本机上的MySQL<br>mysql -h <code>&lt;remote-ip&gt;</code> -u root -p <code>&lt;password&gt;</code>   //链接远程服务器MySQL</p>
</blockquote>
<p><img src="https://i.loli.net/2019/09/11/deFkvLIuGNqOnVa.jpg" alt=""></p>
<ol start="3">
<li><p>常用命令行</p>
<p>这些操作因为没有可视化的用户界面，相当于在图形数据库管理工具navicat中的鼠标操作</p>
<ul>
<li>修改密码    <code>mysqladmin -u用户名 -p旧密码 password 新密码</code></li>
<li>显示数据库    <code>show databases;</code></li>
<li>使用数据库    <code>use &lt;database_name&gt;</code></li>
</ul>
<p>&emsp;&emsp;&emsp;use 语句使MySQL把database_name数据库作为当前数据库使用，用于后续语句<br>&emsp;&emsp;&emsp;语句为一个特定的当前的数据库做标记，不会阻碍访问其它数据库中的表</p>
<ul>
<li><code>select database();</code></li>
<li><code>select &#39;welcome&#39;;</code></li>
</ul>
<p>&emsp;&emsp;&emsp;MySQL中SELECT命令类似于其他编程语言里的print或者write，你可以用它来显示一个字符串、数字、数学表达式的结果</p>
<p><a href="https://blog.csdn.net/sanmu_1/article/details/79809806" target="_blank" rel="noopener">MYSQL——ZIP压缩包方式安装详解</a>&emsp;&emsp;虽然没看，但感觉很厉害的样子&emsp;&emsp;wow~ ⊙o⊙</p>
</li>
</ol>
<p><strong>补充</strong></p>
<ol>
<li>在cmd中执行<strong>mysqld –install 服务名</strong><br>可以不写服务名，默认是mysql，如果需要安装多个服务，那么可以起其他的名字。<br>安装完成后在cmd中执行<strong>net start mysql，</strong>那么服务启动。<br>此时在计算机服务中列表中有了MySQL 可供设置启动<br>如果已经有一个C 盘的，win+x a  <strong>sc delete 服务名</strong><br><code>&quot;C:\Program Files\MySQL\MySQL Server 5.7\bin\mysqld.exe&quot; --defaults-file=&quot;C:\ProgramData\MySQL\MySQL Server 5.7\my.ini&quot; MySQL57</code>   </li>
<li>使用 Navicat 图形界面管理MySQL，链接测试时使用 127.0.0.1 ，若使用localhost，需要联网才能成功链接</li>
<li>my.ini 文件格式，使用ANSI 编码格式</li>
<li><strong>安装后是安装到C 盘的，想移动到F 工程盘</strong>，查看 <code>C:\Program Files\MySQL\MySQL Server 5.7\my.ini</code> 文件，里面的</li>
</ol>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"># 设置为自己MYSQL的安装目录 </span><br><span class="line">basedir&#x3D;C:\Program Files\MySQL\MySQL Server 5.7   --&gt;  设置为自己# basedir&#x3D;&quot;F:&#x2F;MySQL Server 5.7&#x2F;&quot;</span><br><span class="line"># 设置为MYSQL的数据目录 </span><br><span class="line">datadir&#x3D;C:\Program Files\MySQL\MySQL Server 5.7\data   --&gt;  datadir&#x3D;&quot;F:&#x2F;MySQL Server 5.7&#x2F;Data&quot;</span><br><span class="line"></span><br><span class="line">下面还有一个路径     没有影响的路径吧</span><br><span class="line"># Secure File Priv.</span><br><span class="line">secure-file-priv&#x3D;&quot;F:&#x2F;MySQL Server 5.7&#x2F;Uploads&quot;   修改后</span><br><span class="line"></span><br><span class="line">将提到的路径里的文件  先都**复制**到 移动的指定路径，之后路径中 文件结构</span><br><span class="line">MySQL Server 5.7</span><br><span class="line">  bin</span><br><span class="line">  Data</span><br><span class="line">  docs</span><br><span class="line">  include</span><br><span class="line">  lib</span><br><span class="line">  share</span><br><span class="line">  Uploads</span><br><span class="line">  4个文件</span><br></pre></td></tr></table></figure>

<p>还有最重要一步，先看补充1   ，了解个大概，然后 管理员cmd，<code>mysqld --install MYSQL5 --defaults-file=&quot;F:\MySQL Server 5.7\my.ini&quot;</code>  成功返回 <code>Service successfully installed.</code>  这样服务也配置上了my.ini 路径，之后可以删除C 盘的东西了   服务修改为  手动   </p>
<p>移动前，移动后   查看<br><code>mysql&gt; show variables like &#39;%datadir%&#39;;</code> 查看路径是否变化了</p>
<h2 id="基本定义"><a href="#基本定义" class="headerlink" title="基本定义"></a>基本定义</h2><ol>
<li><p>创建、删除数据库</p>
<p><code>CREATE DATABASE &lt;库名&gt;;</code></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">CREATE DATABASE 的语法：</span><br><span class="line">CREATE &#123;DATABASE | SCHEMA&#125; [IF NOT EXISTS] db_name</span><br><span class="line">[[DEFAULT] CHARACTER SET charset_name| [DEFAULT] COLLATE collation_name ...]</span><br><span class="line"></span><br><span class="line">&#x2F;*更改数据库的字符编码*&#x2F;</span><br><span class="line">ALTER DATABASE db_name DEFAULT CHARACTER SET utf8 COLLATE utf8_general_ci</span><br></pre></td></tr></table></figure>
</li>
<li><p>创建、删除、修改表结构</p>
<p>定义表  </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">CREATE TABLE &lt;table_name&gt; (</span><br><span class="line">	&lt;colume_name&gt; &lt;data_type&gt; [列级完整性约束条件]  </span><br><span class="line">	[,&lt;colume_name&gt; &lt;data_type&gt; [列级完整性约束条件]]  </span><br><span class="line">	……  </span><br><span class="line">	[,表级完整性约束条件]</span><br><span class="line">);</span><br></pre></td></tr></table></figure>

<p>修改表   </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">ALTER TABLE &lt;table_name&gt;   &#x2F;*table_name 为要修改的基本表*&#x2F;</span><br><span class="line">[ADD [COLUMN] &lt;新列名&gt; &lt;数据类型&gt; [完整性约束]]   &#x2F;*ADD 子句增加新列、完整性约束条件*&#x2F;</span><br><span class="line">[ADD &lt;表级完整性约束&gt;]</span><br><span class="line">[DROP [COLUMN] &lt;列名&gt; [CASCADE|RESTRICT]] &#x2F;*删除表中列 指定CASCADE，删除引用该列其他对象 *&#x2F;</span><br><span class="line">&#x2F;*指定RESTRICT 被其他对象引用，拒绝删除*&#x2F;</span><br><span class="line">[DROP CONSTRAINT &lt;完整性约束名&gt; [RESTRICT|CASCADE]] &#x2F;*删除指定的完整性约束条件*&#x2F;</span><br><span class="line">[ALTER COLUMN &lt;列名&gt; &lt;数据类型&gt;]; &#x2F;*修改原列定义*&#x2F;测试无法完成（MySQL）更换为</span><br><span class="line">[MODIFY COLUMN &lt;列名&gt; &lt;数据类型&gt;]MySQL中</span><br></pre></td></tr></table></figure>

<p>删除表  </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">DROP TABLE &lt;表名&gt; [RESTRICT|CASCADE];</span><br><span class="line">&#x2F;*RESTRICT 基本表不能被其他表约束引用，才能删除 | CASCADE 级联删除，依赖此表的对象一同删除 *&#x2F;</span><br></pre></td></tr></table></figure>
</li>
<li><p>添加、查询、修改、删除表数据</p>
<p>添加更新数据  </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">INSERT</span><br><span class="line">INTO &lt;表名&gt; [(&lt;属性列&gt;[,&lt;属性列2&gt;] ……)] &#x2F;*没有指明属性列名，新插入元组每个列上均有值*&#x2F;</span><br><span class="line">VALUES(&lt;常量1&gt;[,&lt;常量2&gt;]……)</span><br><span class="line">[(&lt;常量1&gt;[,&lt;常量2&gt;]……)]...;</span><br><span class="line"></span><br><span class="line">&#x2F;*此处的VALUES 可以由SELECT 语句生成要插入的批量数据</span><br></pre></td></tr></table></figure>

<p>查询数据  </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">SELECT [ALL|DISTINCT] &lt;目标列表达式&gt; [,&lt;目标列表达式&gt;]……</span><br><span class="line">FROM &lt;表名或视图名&gt; [,&lt;表名或视图名&gt;……] | (&lt;SELECT 语句&gt;) [AS] &lt;别名&gt;</span><br><span class="line">[WHERE &lt;条件表达式&gt;]</span><br><span class="line">[GROUP BY &lt;列名1&gt; [HAVING &lt;条件表达式&gt;]]</span><br><span class="line">[ORDER BY &lt;列名2&gt; [ASC|DESC]];</span><br><span class="line">&#x2F;*根据WHERE 子句表达式从FROM 子句指定的基本表、视图中找出满足条件的元组，再按SELECT 子句中目标列表达式选出元组中属性值形成结果表*&#x2F;</span><br></pre></td></tr></table></figure>

<p>修改数据</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">UPDATE &lt;表名&gt;</span><br><span class="line">SET &lt;列名&gt;&#x3D;&lt;表达式&gt; [,&lt;列名&gt;&#x3D;&lt;表达式&gt;] ……</span><br><span class="line">[WHERE &lt;条件&gt;];</span><br><span class="line">&#x2F;*修改指定表中满足WHERE子句条件的 元组*&#x2F;</span><br></pre></td></tr></table></figure>

<p>删除数据</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">DELETE</span><br><span class="line">FROM &lt;表名&gt;</span><br><span class="line">[WHERE &lt;条件&gt;];</span><br><span class="line">&#x2F;*从指定表中删除满足WHERE子句条件的所有 元组*&#x2F;</span><br></pre></td></tr></table></figure>
</li>
<li><p>视图</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&#x2F;*从一个或几个基本表（或视图）导出的表，是一个虚表*&#x2F;</span><br><span class="line">CREATE VIEW &lt;视图名&gt; [(&lt;列名&gt; [,&lt;列名&gt;] ...)]</span><br><span class="line">AS &lt;子查询&gt;   &#x2F;*子查询可以是任意SELECT 语句</span><br><span class="line">[WITH CHECK OPTION];</span><br></pre></td></tr></table></figure>
</li>
<li><p>索引</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">CREATE [UNIQUE] [COLUMN] INDEX &lt;索引名&gt;</span><br><span class="line">ON &lt;表名&gt;(&lt;列名&gt;[&lt;次序&gt;][,&lt;列名&gt;[&lt;次序&gt;]]...);</span><br><span class="line"></span><br><span class="line">ALTER INDEX &lt;旧索引名&gt; RENAME TO &lt;新索引名&gt;;</span><br><span class="line"></span><br><span class="line">DROP INDEX &lt;索引名&gt; ON &lt;表名&gt;;</span><br></pre></td></tr></table></figure>

</li>
</ol>
<h2 id="详细案例"><a href="#详细案例" class="headerlink" title="详细案例"></a>详细案例</h2><ol>
<li>表的定义</li>
</ol>
<p>Student表</p>
<table>
<thead>
<tr>
<th>SNO(学号 char 9 主码)</th>
<th>SNAME(姓名 char 20 唯一值)</th>
<th>SEX(性别 char 2)</th>
<th>SAGE(int)</th>
<th>DEPT(所在系 char 20)</th>
</tr>
</thead>
<tbody><tr>
<td>2012121</td>
<td>李勇</td>
<td>男</td>
<td>20</td>
<td>CS</td>
</tr>
<tr>
<td>2012122</td>
<td>王敏</td>
<td>女</td>
<td>19</td>
<td>CS</td>
</tr>
<tr>
<td>2012125</td>
<td>张立</td>
<td>男</td>
<td>19</td>
<td>IS</td>
</tr>
</tbody></table>
<p>Course表</p>
<table>
<thead>
<tr>
<th>CNO(课程号 char 4 主码)</th>
<th>CNAME(char 40 非空)</th>
<th>CPNO(先修此课 char 4 外码(Course(CNO))</th>
<th>CREDIT(int)</th>
</tr>
</thead>
<tbody><tr>
<td>1</td>
<td>数据库</td>
<td>3</td>
<td>4</td>
</tr>
<tr>
<td>2</td>
<td>数学</td>
<td></td>
<td>2</td>
</tr>
<tr>
<td>3</td>
<td>数据结构</td>
<td>5</td>
<td>4</td>
</tr>
<tr>
<td>4</td>
<td>数据处理</td>
<td></td>
<td>2</td>
</tr>
<tr>
<td>5</td>
<td>Java语言</td>
<td>4</td>
<td>4</td>
</tr>
</tbody></table>
<p>选课表SC</p>
<table>
<thead>
<tr>
<th>SNO(char 9 主码)</th>
<th>CNO(char 4 主码)</th>
<th>GRADE(int)</th>
</tr>
</thead>
<tbody><tr>
<td>2012121</td>
<td>1</td>
<td>92</td>
</tr>
<tr>
<td>2012121</td>
<td>2</td>
<td>85</td>
</tr>
<tr>
<td>2012121</td>
<td>3</td>
<td>88</td>
</tr>
<tr>
<td>2012122</td>
<td>2</td>
<td>90</td>
</tr>
<tr>
<td>2012122</td>
<td>3</td>
<td>80</td>
</tr>
</tbody></table>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">DATABASE</span> MESSAGE <span class="keyword">DEFAULT</span> <span class="built_in">CHARACTER</span> <span class="keyword">SET</span> utf8 <span class="keyword">COLLATE</span> utf8_general_ci;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*中间获取还需要一句  使用哪个数据库*/</span></span><br><span class="line"><span class="keyword">USE</span> MESSAGE;</span><br><span class="line"></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> student(</span><br><span class="line">	SNO <span class="built_in">CHAR</span>(<span class="number">9</span>) PRIMARY <span class="keyword">KEY</span>,   <span class="comment">/*列级完整性约束条件*/</span></span><br><span class="line">	SNAME <span class="built_in">CHAR</span>(<span class="number">20</span>) <span class="keyword">UNIQUE</span>,   <span class="comment">/*SNAM取唯一值*/</span></span><br><span class="line">	SEX <span class="built_in">CHAR</span>(<span class="number">2</span>),</span><br><span class="line">	SAGE <span class="built_in">INT</span>,</span><br><span class="line">	DEPT <span class="built_in">CHAR</span>(<span class="number">20</span>)</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> Course(</span><br><span class="line">	CNO <span class="built_in">CHAR</span>(<span class="number">4</span>) PRIMARY <span class="keyword">KEY</span>,</span><br><span class="line">	CNAME <span class="built_in">CHAR</span>(<span class="number">40</span>) <span class="keyword">NOT</span> <span class="literal">NULL</span>,</span><br><span class="line">	CPNO <span class="built_in">CHAR</span>(<span class="number">4</span>),</span><br><span class="line">	CREDIT <span class="built_in">INT</span>,</span><br><span class="line">	<span class="keyword">FOREIGN</span> <span class="keyword">KEY</span>(CPNO) <span class="keyword">REFERENCES</span> Course(CNO)</span><br><span class="line">	<span class="comment">/*表级完整性约束条件，CPNO是外码，被参照表是Course，被参照列是CNO*/</span></span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> SC(</span><br><span class="line">	SNO <span class="built_in">CHAR</span>(<span class="number">9</span>),</span><br><span class="line">	CNO <span class="built_in">CHAR</span>(<span class="number">4</span>),</span><br><span class="line">	GRADE <span class="built_in">INT</span>,</span><br><span class="line">	PRIMARY <span class="keyword">KEY</span>(SNO,CNO),   <span class="comment">/*主码由两个属性构成，必须作为表级完整性进行定义*/</span></span><br><span class="line">	<span class="keyword">FOREIGN</span> <span class="keyword">KEY</span>(SNO) <span class="keyword">REFERENCES</span> Student(SNO),   <span class="comment">/*表级完整性约束条件，Sno是外码，被参照表是Student*/</span></span><br><span class="line">	<span class="keyword">FOREIGN</span> <span class="keyword">KEY</span>(CNO) <span class="keyword">REFERENCES</span> Course(CNO)</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="comment">/*增加元组数据*/</span></span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> Student(SNO,SNAME,SEX,DEPT,SAGE)</span><br><span class="line">	<span class="keyword">VALUES</span></span><br><span class="line">	(<span class="string">'2012121'</span>,<span class="string">'李勇'</span>,<span class="string">'男'</span>,<span class="string">'CS'</span>,<span class="string">'20'</span>),</span><br><span class="line">	(<span class="string">'2012122'</span>,<span class="string">'王敏'</span>,<span class="string">'女'</span>,<span class="string">'CS'</span>,<span class="string">'19'</span>),</span><br><span class="line">	(<span class="string">'2012123'</span>,<span class="string">'张立'</span>,<span class="string">'男'</span>,<span class="string">'IS'</span>,<span class="string">'19'</span>);</span><br><span class="line"><span class="comment">/*此处注意因为字符编码问题中文会报错，所以定义表时在后面添加   charset=utf8 */</span></span><br><span class="line">	</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> Course</span><br><span class="line">	<span class="keyword">VALUES</span></span><br><span class="line">	(<span class="string">'1'</span>,<span class="string">'数据库'</span>,<span class="string">'3'</span>,<span class="number">4</span>),</span><br><span class="line">	(<span class="string">'2'</span>,<span class="string">'数学'</span>,<span class="string">''</span>,<span class="number">2</span>),</span><br><span class="line">	(<span class="string">'3'</span>,<span class="string">'数据结构'</span>,<span class="string">'5'</span>,<span class="number">4</span>),</span><br><span class="line">	(<span class="string">'4'</span>,<span class="string">'数据处理'</span>,<span class="string">''</span>,<span class="number">2</span>),</span><br><span class="line">	(<span class="string">'5'</span>,<span class="string">'Java语言'</span>,<span class="string">'4'</span>,<span class="number">4</span>);</span><br><span class="line"><span class="comment">/*报ERROR 1217     Set FOREIGN_KEY_CHECKS = 0; 关闭外码检查，修改添加完数据改回1*/</span> </span><br><span class="line"><span class="comment">/*[Err] 1452 - Cannot add or update a child row。在命令行里没有问题，但在Navicat 一个Query中报错*/</span></span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> SC</span><br><span class="line">	<span class="keyword">VALUES</span></span><br><span class="line">	(<span class="string">'2012121'</span>,<span class="string">'1'</span>,<span class="number">92</span>),</span><br><span class="line">	(<span class="string">'2012121'</span>,<span class="string">'2'</span>,<span class="number">85</span>),</span><br><span class="line">	(<span class="string">'2012121'</span>,<span class="string">'3'</span>,<span class="number">88</span>),</span><br><span class="line">	(<span class="string">'2012122'</span>,<span class="string">'2'</span>,<span class="number">90</span>),</span><br><span class="line">	(<span class="string">'2012122'</span>,<span class="string">'3'</span>,<span class="number">80</span>);</span><br><span class="line">	</span><br><span class="line"><span class="comment">/*======================= 删除数据库 =======================*/</span></span><br><span class="line"><span class="keyword">DROP</span> <span class="keyword">DATABASE</span> <span class="keyword">IF</span> <span class="keyword">EXISTS</span> <span class="string">`MESSAGE`</span>;</span><br><span class="line"><span class="comment">/*======================= 创建数据库 =======================*/</span></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">DATABASE</span> MESSAGE <span class="keyword">DEFAULT</span> <span class="built_in">CHARACTER</span> <span class="keyword">SET</span> utf8mb4 <span class="keyword">COLLATE</span> utf8mb4_general_ci;</span><br><span class="line"><span class="comment">/*======================= 使用数据库 =======================*/</span></span><br><span class="line"><span class="keyword">USE</span> <span class="string">`MESSAGE`</span>;</span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> TBL_COMMODITY(</span><br><span class="line">	CID <span class="built_in">INT</span> PRIMARY <span class="keyword">KEY</span> <span class="keyword">NOT</span> <span class="literal">NULL</span> AUTO_INCREMENT <span class="keyword">COMMENT</span> <span class="string">'自增商品ID'</span>,</span><br><span class="line">    CNAME <span class="built_in">VARCHAR</span>(<span class="number">20</span>) <span class="keyword">NOT</span> <span class="literal">NULL</span> <span class="keyword">COMMENT</span> <span class="string">'商品名称'</span>,</span><br><span class="line">    CLABEL <span class="built_in">INT</span> <span class="keyword">COMMENT</span> <span class="string">'商品标签'</span> ,</span><br><span class="line">    CPRICE <span class="keyword">DOUBLE</span> <span class="keyword">NOT</span> <span class="literal">NULL</span> <span class="keyword">COMMENT</span> <span class="string">'商品价格'</span>,</span><br><span class="line">    DES <span class="built_in">VARCHAR</span>(<span class="number">1000</span>) <span class="keyword">NOT</span> <span class="literal">NULL</span>,</span><br><span class="line">    PIC <span class="built_in">VARCHAR</span>(<span class="number">1000</span>) <span class="keyword">NOT</span> <span class="literal">NULL</span> <span class="keyword">COMMENT</span> <span class="string">'图片地址'</span>,</span><br><span class="line">    PIC_A <span class="built_in">INT</span> <span class="keyword">NOT</span> <span class="literal">NULL</span> <span class="keyword">COMMENT</span> <span class="string">'图片数量'</span></span><br><span class="line">);</span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> TBL_USER(</span><br><span class="line">    UID <span class="built_in">INT</span>(<span class="number">10</span>) <span class="keyword">NOT</span> <span class="literal">NULL</span> AUTO_INCREMENT <span class="keyword">COMMENT</span> <span class="string">'用户自增ID'</span>,</span><br><span class="line">    UNAME <span class="built_in">VARCHAR</span>(<span class="number">18</span>) <span class="keyword">NOT</span> <span class="literal">NULL</span> <span class="keyword">COMMENT</span> <span class="string">'用户名'</span>,</span><br><span class="line">    UPMSN <span class="built_in">INT</span> <span class="keyword">NOT</span> <span class="literal">NULL</span> <span class="keyword">DEFAULT</span> <span class="string">'0'</span> <span class="keyword">COMMENT</span> <span class="string">'区别用户权限为普通还是管理员'</span>,</span><br><span class="line">    UPWD <span class="built_in">VARCHAR</span>(<span class="number">16</span>) <span class="keyword">NOT</span> <span class="literal">NULL</span> <span class="keyword">COMMENT</span> <span class="string">'用户密码'</span>,</span><br><span class="line">    PHONE <span class="built_in">VARCHAR</span>(<span class="number">11</span>) <span class="keyword">NOT</span> <span class="literal">NULL</span> <span class="keyword">UNIQUE</span> <span class="keyword">COMMENT</span> <span class="string">'用户联系电话，一个手机号只能用于一个用户'</span>,</span><br><span class="line">    EMAIL <span class="built_in">VARCHAR</span>(<span class="number">20</span>) <span class="keyword">COMMENT</span> <span class="string">'可空值，联系邮箱'</span>,</span><br><span class="line">    PRIMARY <span class="keyword">KEY</span>(UID,UNAME)</span><br><span class="line">);</span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> TBL_Item(</span><br><span class="line">    CUID <span class="built_in">INT</span> PRIMARY <span class="keyword">KEY</span> AUTO_INCREMENT <span class="keyword">COMMENT</span> <span class="string">'用户对应提供商品自增ID'</span>,</span><br><span class="line">    FCID <span class="built_in">INT</span>,</span><br><span class="line">    FUID <span class="built_in">INT</span>,</span><br><span class="line">    QUANTITY <span class="built_in">INT</span> <span class="keyword">NOT</span> <span class="literal">NULL</span> <span class="keyword">COMMENT</span> <span class="string">'货物数量'</span>,</span><br><span class="line">    <span class="keyword">FOREIGN</span> <span class="keyword">KEY</span>(FCID) <span class="keyword">REFERENCES</span> TBL_COMMODITY(CID),</span><br><span class="line">    <span class="keyword">FOREIGN</span> <span class="keyword">KEY</span>(FUID) <span class="keyword">REFERENCES</span> TBL_USER(UID)</span><br><span class="line">);</span><br></pre></td></tr></table></figure>

<p>定义完，想要看一看这些表的结构</p>
<blockquote>
<p>show columns from 表名;<br>desc 表名;  //全称 describe 表名;  //推荐<br>show create table 表名;   //推荐 </p>
</blockquote>
<h3 id="查询表操作"><a href="#查询表操作" class="headerlink" title="查询表操作"></a>查询表操作</h3><p>   【1】查询所有学生姓名，学号</p>
<p>   ​    <code>SELECT SNO,SNAME FROM Student</code></p>
<p>   ​    <code>SELECT SNO,SNAME,SAGE,SEX,DEPT</code> 等价于 <code>SELECT *</code></p>
<p>   【2】查询学生姓名与出生年份</p>
<p>   ​    数据库表中明显看出没有直接的出生年份信息，但可以由年龄求出</p>
<p>   ​    <code>SELECT SNAME,2019-SAGE FROM Student</code></p>
<p>   ​    <img src="https://i.loli.net/2019/09/19/b9nh3kDXq5JwmRs.jpg" alt=""></p>
<p>   ​    怎样美观一些，’2019-SAGE’取个名字，就在表达式后加上名称</p>
<p>   ​    <code>SELECT SNAME,2019-SAGE BIRTH FROM Student</code></p>
<p>   【3】重复行消除</p>
<p>   ​    <code>SELECT SNO FROM SC;</code> &emsp;&emsp;&emsp;|&emsp;&emsp;&emsp;<code>SELECT DISTINCT SNO FROM SC;</code>    没有distinct关键字，默认ALL</p>
   <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">+---------+		|	+---------+</span><br><span class="line">| SNO     |		|	| sno     |</span><br><span class="line">+---------+		|	+---------+</span><br><span class="line">| 2012121 |		|	| 2012121 |</span><br><span class="line">| 2012121 |		|	| 2012122 |</span><br><span class="line">| 2012122 |		|	+---------+</span><br><span class="line">| 2012121 |		|	</span><br><span class="line">| 2012122 |		|	</span><br><span class="line">+---------+		|</span><br></pre></td></tr></table></figure>

<h4 id="查询满足条件的元组"><a href="#查询满足条件的元组" class="headerlink" title="查询满足条件的元组"></a>查询满足条件的元组</h4><table>
<thead>
<tr>
<th>查询条件</th>
<th>谓词</th>
</tr>
</thead>
<tbody><tr>
<td>比较</td>
<td>=,&gt;,&lt;,&gt;=,&lt;=,!=,&lt;&gt;,!&gt;,!&lt;;NOT+上述</td>
</tr>
<tr>
<td>确定范围</td>
<td>BETWEEN AND, NOT BETWEEN AND</td>
</tr>
<tr>
<td>确定集合</td>
<td>IN, NOT IN</td>
</tr>
<tr>
<td>字符匹配</td>
<td>LIKE, NOT LIKE</td>
</tr>
<tr>
<td>空值</td>
<td>IS NULL, IS NOT NULL</td>
</tr>
<tr>
<td>多重条件（逻辑运算）</td>
<td>AND, OR, NOT</td>
</tr>
</tbody></table>
<p>&emsp;&emsp;【5】计算机科学系学生<br>        &emsp;&emsp;<code>SELECT * FROM Student WHERE DEPT=&#39;CS&#39;</code><br>        &emsp;&emsp;关系数据库处理过程一种可能：对Student表进行全表扫描，取出一个元组，检查在DEPT列值是否等于’CS’，如果相等，取出该元组需要的SELECT值，形成新元组输出，否则跳过取下一个元组。<br>        &emsp;&emsp;如果人数很多，而满足要求的元组较少，在Student表DEPT列建立索引，系统利用该索引找出DEPT=’CS’元组，形成结果表，避免全表扫描，加快查询速度。</p>
<p>&emsp;&emsp;【6】查询年龄在19-21之间的学生姓名、系<br>        &emsp;&emsp;范围BETWEEN，BETWEEN后是范围的下限，AND 后是范围的上限<br>    &emsp;&emsp;    <code>SELECT SNAME,DEPT FROM Student WHERE SAGE BETWEEN 19 AND 21</code></p>
<p>&emsp;&emsp;【7】查询CS 、IS 系学生姓名，性别<br>        &emsp;&emsp;谓词IN 某一属性值属于指定集合的元组<br>        &emsp;&emsp;<code>SELECT SNAME,SEX FROM Student WHERE DEPT IN (&#39;CS&#39;,&#39;IS&#39;)</code></p>
<p>&emsp;&emsp;<font color=red>以上均可查询相反条件，加 NOT 即可</font></p>
<p>&emsp;&emsp;【8】LIKE 字符匹配<br>        &emsp;&emsp;<code>[NOT] LIKE &#39;&lt;匹配串&gt;&#39; [ESCAPE &#39;&lt;换码字符&gt;&#39;]</code><br>    &emsp;&emsp;    指定的属性列值与&lt;匹配串&gt;相匹配的元组，类似正则，通配符<br>        &emsp;&emsp;i. % 代表任意长度的字符串<br>        &emsp;&emsp;ii. _ 代表任意单个字符<br>        &emsp;&emsp;&emsp;<code>SELECT SNAME FROM Student WHERE SNAME LIKE &#39;刘%&#39;</code>  //查询刘姓学生<br>        &emsp;&emsp;&emsp;<code>SELECT SNAME FROM Student WHERE SNAME LIKE &#39;欧阳_&#39;</code>  //查询三个汉字的欧阳姓学生</p>
<p>&emsp;&emsp;<font color=red>数据库字符集为ASCII时一个汉字需两个_；当字符集为GBK 时只需一个 _。</font></p>
<p>​    &emsp;&emsp;如果查询字符串本身就有通配符，要使用 ESCAPE ‘&lt;换码字符&gt;’ 对通配符进行转义<br>&emsp;&emsp;&emsp;&emsp;<code>SELECT * FROM Course WHERE CNAME LIKE &#39;DB\_Design&#39; ESCAPE &#39;\&#39;</code><br>&emsp;&emsp;&emsp;&emsp;<code>ESCAPE &#39;\&#39;</code> 表示 “\“ 为换码字符，只管后面紧跟的一个通配符，成为普通的_ 字符</p>
<p>&emsp;&emsp;【9】涉及空值查询<br>&emsp;&emsp;&emsp;&emsp;学生选课但未考试，有选课记录但无成绩<br>&emsp;&emsp;&emsp;&emsp;<code>SELECT SNO,CNO FROM SC WHERE GRADE IS NULL</code>   //<font color=red>这里的 IS 不能与等号代替</font></p>
<p>&emsp;&emsp;【10】多重条件查询<br>&emsp;&emsp;&emsp;&emsp;条件 WHERE 那里按照条件要求使用多个连接词<br>&emsp;&emsp;&emsp;&emsp;IN 谓词就是多个 OR 运算符缩写<br>&emsp;&emsp;&emsp;&emsp;<code>IN (&#39;CS&#39;,&#39;IS&#39;)</code>  &lt;=&gt; <code>DEPT=&#39;CS&#39; OR DEPT=&#39;IS&#39;</code></p>
<h4 id="ORDER-BY-子句"><a href="#ORDER-BY-子句" class="headerlink" title="ORDER BY 子句"></a>ORDER BY 子句</h4><blockquote>
<p>用户可以对查询结果按照一个或多个属性列的升序 ASC 或降序 DESC 排列，默认ASC</p>
</blockquote>
<p>&emsp;&emsp;【1】查询选修了3号课程学生学号、成绩，结果降序排列<br>&emsp;&emsp;&emsp;&emsp;<code>SELECT SNO,GRADE FROM SC WHERE CNO=&#39;3&#39; ORDER BY GRADE DESC</code><br>&emsp;&emsp;&emsp;&emsp;至于之前说的选课但未考试无成绩的空值，NULL 看系统决定</p>
<p>&emsp;&emsp;&emsp;全体学生，结果按所在系系号升序排列，同一系学生按年龄降序排列<br>&emsp;&emsp;&emsp;&emsp;<code>SELECT * FROM Student ORDER BY DEPT,SAGE DESC</code></p>
<h4 id="聚集函数"><a href="#聚集函数" class="headerlink" title="聚集函数"></a>聚集函数</h4><ul>
<li>COUNT(*)</li>
<li>COUNT([DISTINCT|ALL] &lt;列名&gt;)</li>
<li>SUM([DISTINCT|ALL] &lt;列名&gt;)</li>
<li>AVG([DISTINCT|ALL] &lt;列名&gt;)</li>
<li>MAX([DISTINCT|ALL] &lt;列名&gt;)</li>
<li>MIN([DISTINCT|ALL] &lt;列名&gt;)</li>
</ul>
<p>&emsp;&emsp;【1】查询学生总数<br>&emsp;&emsp;&emsp;&emsp;<code>SELECT COUNT(*) FROM Student</code><br>&emsp;&emsp;&emsp;查询选修了课程的学生<br>&emsp;&emsp;&emsp;&emsp;<code>SELECT COUNT(DISTINCT SNO) FROM SC</code>  //消除重复行后的元组个数</p>
<p>&emsp;&emsp;【2】选秀2课程的最高分<br>&emsp;&emsp;&emsp;&emsp;<code>SELECT MAX(GRADE) FROM SC WHERE CNO=&#39;2&#39;</code></p>
<p>&emsp;&emsp;【3】学生2012122选秀课程总学分数<br>&emsp;&emsp;&emsp;&emsp;<code>SELECT SUM(CREDIT) FROM SC,Course WHERE SNO=&#39;2012122&#39; AND SC.CNO=Course.CNO;</code></p>
<p>除COUNT(*) 外，其余聚集函数跳过空值只处理非空值</p>
<p>WHERE 子句中不能用聚集函数作为条件表达式，聚集函数只能出现在SELECT子句和GROUP BY 中的HAVING子句</p>
<h4 id="GROUP-BY"><a href="#GROUP-BY" class="headerlink" title="GROUP BY"></a>GROUP BY</h4><blockquote>
<p>查询结果按某一列或多列值分组，值相等的为一组<br>目的是细化聚集函数作用对象。分组后聚集函数将作用于每一个组，每一个组都有一个函数值</p>
</blockquote>
<p>&emsp;&emsp;【1】求各个课程号选课人数<br>&emsp;&emsp;&emsp;&emsp;<code>SELECT CNO,COUNT(SNO) FROM SC GROUP BY CNO;</code><br>&emsp;&emsp;&emsp;&emsp;按 CNO 的值分组，相同 CNO 值为一组，对每一个组作用聚集函数 COUNT 计算  </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">+-----+------------+</span><br><span class="line">| CNO | COUNT(SNO) |</span><br><span class="line">+-----+------------+</span><br><span class="line">| 1   |          1 |</span><br><span class="line">| 2   |          2 |</span><br><span class="line">| 3   |          2 |</span><br><span class="line">+-----+------------+</span><br></pre></td></tr></table></figure>

<p>再添加条件对这个结果进行筛选，使用<font color=red>HAVING 子句</font>指定条件</p>
<p>&emsp;&emsp;【2】选修了3门课以上学生学号<br>&emsp;&emsp;&emsp;&emsp;<code>SELECT SNO FROM SC GROUP BY SNO HAVING COUNT(*)&gt;3;</code><br>&emsp;&emsp;&emsp;&emsp;先用GROUP BY 子句按SNO 进行分组，再用聚集函数COUNT 对每一组计数；HAVING 选择输出组的条件</p>
<p>WHERE 与HAVING <font color=red>区别</font>在于<font color=red>作用对象不同</font><br>&emsp;&emsp;<font color=yellow>WHERE 子句作用与基本表，选择满足条件的<font color=red>元组</font>；HAVING 作用于组，从中选择满足条件的<font color=red>组</font></font></p>
<p>&emsp;&emsp;【3】平均成绩大于等于90分的学生学号和平均成绩<br>&emsp;&emsp;&emsp;&emsp;<code>SELECT SNO,AVG(GRADE) FROM SC GROUP BY SNO HAVING AVG(GRADE)&gt;=90;</code></p>
<h4 id="连接查询（两个以上表）"><a href="#连接查询（两个以上表）" class="headerlink" title="连接查询（两个以上表）"></a>连接查询（两个以上表）</h4><p>WHERE 子句中连接两个表的条件 连接条件（连接谓词）<br>&emsp;&emsp;[&lt;表名1&gt;.]&lt;列名1&gt;&lt;比较运算符&gt;[&lt;表名2&gt;.]&lt;列名2&gt;<br>&emsp;&emsp;比较运算符为 = ，为等值连接，其他运算符为 非等值连接</p>
<p>&emsp;&emsp;【1】查询学生及其选秀课程情况<br>&emsp;&emsp;&emsp;&emsp;学生情况放在student 表中，学生选课情况放在SC 表中，查询涉及两个表。两表建联系是公共属性SNO实现<br>&emsp;&emsp;&emsp;&emsp;<code>SELECT Student.*,SC.* FROM Student,SC WHERE Student.SNO=SC.SNO;</code>  </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">+---------+-------+------+------+--------+---------+-----+-------+</span><br><span class="line">| Student.SNO| SNAME | SEX  | SAGE | DEPT | SC.SNO     | CNO | GRADE |</span><br><span class="line">+---------+-------+------+------+--------+---------+-----+-------+</span><br><span class="line">| 2012121    | 李勇  | 男   |   20 | CS     | 2012121     | 1   |    92 |</span><br><span class="line">| 2012121    | 李勇  | 男   |   20 | CS     | 2012121     | 2   |    85 |</span><br><span class="line">| 2012121    | 李勇  | 男   |   20 | CS     | 2012121     | 3   |    88 |</span><br><span class="line">| 2012122    | 王敏  | 女   |   19 | CS     | 2012122     | 2   |    90 |</span><br><span class="line">| 2012122    | 王敏  | 女   |   19 | CS     | 2012122     | 3   |    80 |</span><br><span class="line">+---------+-------+------+------+--------+---------+-----+-------+</span><br></pre></td></tr></table></figure>

<p>公共属性SNO 加表名前缀避免混淆，属性唯一，可以省略</p>
<p>连接操作过程：</p>
<p>&emsp;&emsp;<font color=yellow>嵌套循环连接算法：</font> 在student表中找到第一个元组，然后从头开始扫描SC表，逐一查找与student第一个元组的sno相等的SC元组，找到后将student第一个元组与该元组连接。sc表查找完，再找student表第二个元组，再从头开始扫描SC，注意查找满足连接条件的元组，找到后将student表第二个元组与该元组连接。重复直到student表中全部元组处理完毕。</p>
<p>等值连接 目标列中重复属性列去掉则为自然连接</p>
<p>&emsp;&emsp;<code>SELECT Student.SNO,SNAME,SEX,SAGE,DEPT,CNO,GRADE FROM Student,SC WHERE Student.SNO=SC.SNO;</code></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">+---------+-------+------+------+--------+-----+-------+</span><br><span class="line">| SNO     | SNAME | SEX  | SAGE | DEPT | CNO | GRADE |</span><br><span class="line">+---------+-------+------+------+--------+-----+-------+</span><br><span class="line">| 2012121 | 李勇  | 男   |   20 | CS     | 1   |    92 |</span><br><span class="line">| 2012121 | 李勇  | 男   |   20 | CS     | 2   |    85 |</span><br><span class="line">| 2012121 | 李勇  | 男   |   20 | CS     | 3   |    88 |</span><br><span class="line">| 2012122 | 王敏  | 女   |   19 | CS     | 2   |    90 |</span><br><span class="line">| 2012122 | 王敏  | 女   |   19 | CS     | 3   |    80 |</span><br><span class="line">+---------+-------+------+------+--------+-----+-------+</span><br></pre></td></tr></table></figure>

<p>&emsp;&emsp;【2】查询选修2课程且成绩再90分上的学生学号，姓名<br>&emsp;&emsp;&emsp;&emsp;<code>SELECT Student.SNO,SNAME FROM Student,SC WHERE Student.SNO=SC.SNO AND SC.CNO=&#39;2&#39; AND SC.GRADE&gt;90;</code>  </p>
<p>查询操作一般怎么优化高效怎么来，先条件选择元组，形成中间关系，再连接</p>
<p>&emsp;&emsp;【3】自身连接<br>&emsp;&emsp;&emsp;&emsp;先修课的先修课，在course 表中只有直接先修课。<br>&emsp;&emsp;&emsp;&emsp;先找到一门课的先修课，再按此先修课的课程号找它的先修课<br>&emsp;&emsp;&emsp;&emsp;Course 表自身连接，取表名字FIRST,SECOND<br>&emsp;&emsp;&emsp;&emsp;<code>SELECT FIRST.CNO,SECOND.CPNO FROM Course FIRST,Course SECOND WHERE FIRST.CPNO=SECOND.CNO;</code></p>
<p>&emsp;&emsp;【4】外连接<br>&emsp;&emsp;&emsp;&emsp;不说了</p>
<p>&emsp;&emsp;【5】多表连接  ，查询每个学生学号、姓名、选修课程名及成绩<br>&emsp;&emsp;&emsp;&emsp;课程成绩在 SC 表，课程名在Course 表，学生信息 Student 表<br>&emsp;&emsp;&emsp;&emsp;<code>SELECT Student.SNO,SNAME,CNAME,GRADE FROM Student,Course,SC WHERE Student.SNO=SC.SNO AND SC.CNO=Course.CNO;</code></p>
<h4 id="嵌套循环"><a href="#嵌套循环" class="headerlink" title="嵌套循环"></a>嵌套循环</h4><blockquote>
<p>&emsp;&emsp;一个SELECT-FROM-WHERE 语句称为一个查询块，一个查询块嵌套在另一个查询块的WHERE 或 HAVING 短语，子查询，父查询</p>
</blockquote>
<p><font color=red>子查询的SELECT 语句不能使用ORDER BY 子句，只能对最终查询结果排序</font></p>
<p>&emsp;&emsp;【1】查询与‘李勇’在同一系的学生姓名<br>&emsp;&emsp;&emsp;&emsp;i.首先确定‘李勇’在哪个系<br>&emsp;&emsp;&emsp;&emsp;<code>SELECT DEPT FROM Student WHERE SNAME=&#39;李勇&#39;;</code>  查找结果为CS<br>&emsp;&emsp;&emsp;&emsp;ii.查找所有CS 系学生<br>&emsp;&emsp;&emsp;&emsp;<code>SELECT SNO,SNAME FROM Student WHERE DEPT=&#39;CS&#39;</code><br>&emsp;&emsp;&emsp;&emsp;将i 嵌入 ii 中<br>&emsp;&emsp;&emsp;&emsp;<code>SELECT SNO,SNAME FROM Student WHERE DEPT IN (SELECT DEPT FROM Student WHERE SNAME=&#39;李勇&#39;);</code>/此处IN 这里知道只有一个 ‘CS’，可以用 = 代替，多个结果时不可以<br>&emsp;&emsp;&emsp;&emsp;解法二：<br>&emsp;&emsp;&emsp;&emsp;<code>SELECT S1.SNO,S2.SNAME,S1.DEPT FROM Student S1,Student S2 WHERE S1.DEPT=S2.DEPT AND S2.SNAME=&#39;李勇&#39;;</code></p>
<p><font color=yellow>子查询查询条件不依赖父查询，称为不相关子查询</font></p>
<p>同一个查询请求可以有多种方法，但执行效率不同</p>
<p>&emsp;&emsp;【2】查询选修课程名为‘数据结构’的学生学号，姓名<br>&emsp;&emsp;&emsp;&emsp;涉及学号、姓名、课程名属性，Student，Course表中，但两表无直接联系，需通过SC<br>&emsp;&emsp;&emsp;&emsp;<code>SELECT SNO,SNAME FROM Student WHERE SNO IN (SELECT SNO FROM SC WHERE CNO IN (SELECT CNO FROM Course WHERE CNAME=&#39;数据结构&#39;));</code>  排版可以一块一块缩进<br>&emsp;&emsp;&emsp;&emsp;ii.<code>SELECT Student.SNO,SNAME FROM Student,SC,Course WHERE Student.SNO=SC.SNO AND SC.CNO=Course.CNO AND Course.CNAME=&#39;数据结构&#39;;</code></p>
<p><font color=yellow>能够连接运算表达的查询尽可能采用连接查询</font></p>
<p>&emsp;&emsp;【3】<font color=red>相关嵌套查询：</font>查询每个学生超过自己选修课程平均成绩的课程号<br>&emsp;&emsp;&emsp;&emsp;<code>SELECT SNO,CNO FROM SC X WHERE GRADE&gt;=(SELECT AVG(GRADE) FROM SC Y WHERE Y.SNO=X.SNO);</code><br>&emsp;&emsp;&emsp;&emsp;X是SC 表别名，用来表示SC 一个元组。内层查询求一个学生所有选修课程平均成绩的，之于是哪个要看<font color=yellow>参数X.SNO的值</font><br>&emsp;&emsp;&emsp;&emsp;i. 从外层查询中取出SC的一个元组X，将元组X的SNO值(2012121)传送给内层查询<br>&emsp;&emsp;&emsp;&emsp;<code>SELECT AVG(GRADE) FROM SC Y WHERE Y.SNO=&#39;2012121&#39;;</code><br>&emsp;&emsp;&emsp;&emsp;ii. 执行内层查询，得到平均值a，代替内层查询，得到外层查询<br>&emsp;&emsp;&emsp;&emsp;<code>SELECT SNO,CNO FROM SC X WHERE GRADE&gt;=a;</code><br>&emsp;&emsp;&emsp;&emsp;iii. 外层查询取下一个元组重复上述步骤，直到外层的SC 元组全部处理完毕</p>
<p>返回单值时可以用比较运算符，但返回多值要用ANY 或 ALL 谓词修饰符同时使用比较运算符</p>
<ul>
<li>&gt;ALL    大于子查询结果中的所有值</li>
<li>&gt;ANY    大于子查询结果中的某个值</li>
</ul>
<p>&emsp;&emsp;【4】查询非计算机系中比计算机系任意一个学生年龄小的学生姓名和年龄<br>&emsp;&emsp;&emsp;&emsp;<code>SELECT SNAME,SAGE FROM Student WHERE SAGE&lt;ANY(SELECT SAGE FROM Student WHERE DEPT=&#39;CS&#39;) AND DEPT&lt;&gt;&#39;CS&#39; and sleep(3);</code><br>&emsp;&emsp;&emsp;&emsp;ANY 更换为比较运算符，子查询就要查询出最大 MAX() 聚集函数</p>
<ul>
<li>EXISTS 谓词，存在量词∃，不反悔任何数据，之产生逻辑值true，false</li>
</ul>
<p>&emsp;&emsp;【5】查询所有选修了1 号课程的学生姓名<br>&emsp;&emsp;&emsp;&emsp;<code>SELECT SNAME FROM Student WHERE EXISTS (SELECT * FROM SC WHERE SNO=Student.SNO AND CNO=&#39;1&#39;);</code><br>&emsp;&emsp;&emsp;&emsp;使用EXISTS后，内层查询结果非空，则外层的WHERE 子句返回真值，否则返回假值<br>&emsp;&emsp;&emsp;&emsp;由EXISTS引出的内层查询，目标列表达式一般是*，确定目标列没有意义<br>&emsp;&emsp;首先取外层查询中Student表的第一个元组，根据与内层查询相关的属性值SNO 处理内层查询，若WHERE子句返回true ，则取外层查询中该元组的SNAME 放入结果表；然后再取Student表的下一个元组。重复至外层表查完。</p>
<p>&emsp;&emsp;【6】查询选修全部课程的学生姓名<br>&emsp;&emsp;&emsp;&emsp;SQL 没有全称量词 ∀ ，可以用存在量词转换  $(\forall x)P≡\neg(\exists(\neg P))​$  没有一门课程是他不选修的<br>&emsp;&emsp;&emsp;&emsp;<code>SELECT SNAME FROM Student WHERE NOT EXISTS (SELECT * FROM Course WHERE NOT EXISTS (SELECT * FROM SC WHERE SNO=Student.SNO AND CON=Course.CNO));</code></p>
<p>&emsp;&emsp;【7】查询至少选修了学生2012122选修的全部课程的学生学号<br>&emsp;&emsp;&emsp;&emsp;使用到逻辑蕴涵：查询学号为x 的学生，对所有课程y ，只要2012122学生选修了课程y ，则x 也选修了y<br>&emsp;&emsp;&emsp;&emsp;p 表示谓词 ：学生2012122选修了课程y<br>&emsp;&emsp;&emsp;&emsp;q 表示谓词 ：学生x选修了课程y<br>&emsp;&emsp;&emsp;&emsp;表示为  &emsp;$(\forall y)p \rightarrow q$<br>&emsp;&emsp;&emsp;&emsp;SQL没有蕴涵运算(implication)，需要推理出由存在量词得出的蕴涵逻辑运算<br>&emsp;&emsp;&emsp;&emsp;$p\rightarrow q \equiv \neg p \lor q$<br>&emsp;&emsp;&emsp;&emsp;所以：$(\forall y)p \rightarrow q \equiv \neg (\exists y(\neg (p \rightarrow q)))\equiv \neg (\exists y(\neg (\neg p \lor q)))\equiv \neg \exists y(p\land \neg q)$<br>&emsp;&emsp;&emsp;&emsp;不存在这样的课程y，学生2012122选修了y，而学生x 没有选<br>&emsp;&emsp;&emsp;&emsp;<code>SELECT DISTINCT SNO FROM SC SCX WHERE NOT EXISTS (SELECT * FROM SC SCY WHERE SCY.SNO=&#39;2012122&#39; AND NOT EXISTS (SELECT * FROM SC SCZ WHERE SCZ.SNO=SCX.SNO AND SCZ.CNO=SCY.CNO)</code></p>
<h4 id="集合查询"><a href="#集合查询" class="headerlink" title="集合查询"></a>集合查询</h4><blockquote>
<p>既然结果是元组的集合，那么多个SELECT 语句结果可进行集合操作。<br>并操作 UNION  交操作 INTERSECT  差操作 EXCEPT<br><font color=red>参加集合操作的各查询结果 列数必须相同；对应项的数据类型也必须相同</font></p>
</blockquote>
<h3 id="修改表操作"><a href="#修改表操作" class="headerlink" title="修改表操作"></a>修改表操作</h3><p>​    【1】向Student表增加“入学时间”列，类型为日期型<br>&emsp;&emsp;&emsp;&emsp;<code>ALTER TABLE Student ADD s_entrence DATE</code></p>
<p>不论基本表中原来是否有数据，<font color=red>新增加的列一律为空值</font>—&gt;<font color=red>不能增加主属性列</font></p>
<h4 id="插入数据"><a href="#插入数据" class="headerlink" title="插入数据"></a>插入数据</h4><p>已知插入表的属性列顺序及数据类型时</p>
<p>&emsp;&emsp;【1】<code>INSERT INTO Student VALUES(&#39;2012126&#39;,&#39;陈冬&#39;,&#39;男&#39;,18,&#39;IS&#39;)</code></p>
<p>规定插入数据数量，不用顾虑表格自身属性列顺序</p>
<p>&emsp;&emsp;【2】<code>INSERT INTO SC(SNO,CNO) VALUES(&#39;2012126&#39;,&#39;1&#39;)</code><br>&emsp;&emsp;&emsp;&emsp;将新插入记录的GRADE 列自动赋空值，相当于<br>&emsp;&emsp;&emsp;&emsp;<code>INSERT INTO SC VALUES(&#39;2012126&#39;,&#39;1&#39;,NULL)</code></p>
<h4 id="修改数据"><a href="#修改数据" class="headerlink" title="修改数据"></a>修改数据</h4><p>​    【1】将2012121年龄改为22岁<br>&emsp;&emsp;&emsp;&emsp;<code>UPDATE Student SET SAGE=22 WHERE SNO=&#39;2012121&#39;</code></p>
<p>&emsp;&emsp;【2】将计算机系学生成绩置零<br>&emsp;&emsp;&emsp;&emsp;<code>UPDATE SC SET GRADE=0 WHERE SNO IN (SELECT SNO FROM Student WHERE DEPT=&#39;CS&#39;)</code><br>&emsp;&emsp;&emsp;&emsp;修改数据语句可以带子查询语句</p>
<h4 id="删除数据"><a href="#删除数据" class="headerlink" title="删除数据"></a>删除数据</h4><blockquote>
<p>只对一个表操作，从指定表中删除满足WHERE 子句条件的元组，是表中数据，不是表的定义</p>
</blockquote>
<p>&emsp;&emsp;【1】删除所有选课记录，即删除SC 表所有数据<br>&emsp;&emsp;&emsp;&emsp;<code>DELETE FROM SC;</code></p>
<p>&emsp;&emsp;【2】删除计算机系所有学生的选课记录<br>&emsp;&emsp;&emsp;&emsp;<code>DELETE FROM SC WHERE SNO IN (SELETE SNO FROM Student WHERE DEPT=&#39;CS&#39;)</code></p>
<h3 id="数据库完整性约束"><a href="#数据库完整性约束" class="headerlink" title="数据库完整性约束"></a>数据库完整性约束</h3><h4 id="实体完整性"><a href="#实体完整性" class="headerlink" title="实体完整性"></a>实体完整性</h4><blockquote>
<p>在CREATE TABLE 中用PRIMARY KEY 定义<br>单属性有 列级约束条件，表级约束条件<br>多属性  表级约束条件</p>
</blockquote>
<p>每当对基本表插入一条记录或对主码列进行更新操作，将按照实体完整性规则自动检查<br>(1) 检查主码值是否唯一，不唯一拒绝插入或修改<br>(2)检查主码的各个属性是否为空，只要一个为空就拒接操作</p>
<h4 id="参照完整性"><a href="#参照完整性" class="headerlink" title="参照完整性"></a>参照完整性</h4><blockquote>
<p>CREATE TABLE 中<br>用FOREIGN KEY 短语定义哪些列为外码<br>用REFERENCES 指明这些外码参照哪些表的主码</p>
</blockquote>
<p>一般参照表和参照表操作违反参照完整性时，系统选用默认策略，即 NO ACTION 拒绝执行<br>若想让系统采用其他策略则必须创建时说明</p>
<p>&emsp;&emsp;【1】显示说明 示例  </p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> SC(</span><br><span class="line">SNO <span class="built_in">CHAR</span>(<span class="number">9</span>), </span><br><span class="line">CNO <span class="built_in">CHAR</span>(<span class="number">4</span>),</span><br><span class="line">GRADE <span class="built_in">INT</span>,</span><br><span class="line">PRIMARY <span class="keyword">KEY</span>(SNO,CNO),</span><br><span class="line"><span class="keyword">FOREIGN</span> <span class="keyword">KEY</span>(SNO) <span class="keyword">REFERENCES</span> Student(SNO)  <span class="comment">/*表级参照完整性*/</span></span><br><span class="line">	<span class="keyword">ON</span> <span class="keyword">DELETE</span> <span class="keyword">CASCADE</span>  <span class="comment">/*当删除Student表中的元组时，级联删除SC 表中相应元组*/</span></span><br><span class="line">	<span class="keyword">ON</span> <span class="keyword">UPDATE</span> <span class="keyword">CASCADE</span>,  <span class="comment">/*当更新Student表中的SNO 时，级联更新SC 表中相应元组*/</span></span><br><span class="line"><span class="keyword">FOREIGN</span> <span class="keyword">KEY</span>(CNO) <span class="keyword">REFERENCES</span> Course(CNO)</span><br><span class="line">	<span class="keyword">ON</span> <span class="keyword">DELETE</span> <span class="keyword">NO</span> <span class="keyword">ACTION</span>  <span class="comment">/*当删除Course 表中的元组造成与SC 表不一致时，拒绝删除*/</span></span><br><span class="line">	<span class="keyword">ON</span> <span class="keyword">UPDATE</span> <span class="keyword">CASCADE</span>  <span class="comment">/*当更新Course 表中的CNO 时，级联更新SC 表中相应的元组*/</span></span><br><span class="line">);</span><br></pre></td></tr></table></figure>

<h4 id="用户定义完整性"><a href="#用户定义完整性" class="headerlink" title="用户定义完整性"></a>用户定义完整性</h4><p>(1) 列值非空 NOT NULL<br>(2) 列值唯一 UNIQUE<br>(3) 检查列值是否满足一个条件表达式(CHECK 短语)</p>
<p>表中插入或修改属性值时，检查元组上的约束条件是否满足，不满足则拒绝执行。</p>
<p>&emsp;&emsp;【1】 (3) 示例<br>&emsp;&emsp;&emsp;&emsp;<code>CREATE TABLE Student(SEX CHAR(2) CHECK(SEX IN (&#39;男&#39;,&#39;女&#39;))) /*性别属性只取。。*/</code><br>&emsp;&emsp;&emsp;&emsp;<code>CREATE TABLE SC(GRADE INT CHECK(GRADE&gt;=0 AND GRADE &lt;=100)) /*GRADE 取值范围[0,100]*/</code><br>&emsp;&emsp;&emsp;&emsp;这里碰到点问题，在mysql 中添加COMMENT 注释，写到check 后面报错，写前面不报错<br>&emsp;&emsp;&emsp;&emsp;其实，这里CHECK语句会被忽略，因为MySQL被没有实现这个功能。在<a href="https://dev.mysql.com/doc/refman/5.7/en/create-table.html#create-table-indexes-keys" target="_blank" rel="noopener">官方文档</a>里<br><code>The CHECK clause is parsed but ignored by all storage engines. See Section 1.8.2.3, “Foreign Key Differences”</code>  </p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*怎么解决 条件约束*/</span></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> <span class="string">`Student`</span> (</span><br><span class="line">  <span class="string">`Sno`</span> <span class="built_in">char</span>(<span class="number">8</span>) <span class="keyword">NOT</span> <span class="literal">NULL</span>,</span><br><span class="line">  <span class="string">`Sname`</span> <span class="built_in">varchar</span>(<span class="number">10</span>) <span class="keyword">NOT</span> <span class="literal">NULL</span>,</span><br><span class="line">  <span class="string">`Sex`</span> enum(<span class="string">'男'</span>,<span class="string">'女'</span>) <span class="keyword">NOT</span> <span class="literal">NULL</span> <span class="keyword">DEFAULT</span> <span class="string">'男'</span>,<span class="comment">/*枚举*/</span></span><br><span class="line">  <span class="string">`Age`</span> <span class="built_in">tinyint</span>(<span class="number">4</span>) <span class="keyword">NOT</span> <span class="literal">NULL</span> <span class="keyword">DEFAULT</span> <span class="string">'20'</span>,</span><br><span class="line">  <span class="string">`Phonenumber`</span> <span class="built_in">char</span>(<span class="number">12</span>) <span class="keyword">DEFAULT</span> <span class="literal">NULL</span>,</span><br><span class="line">  PRIMARY <span class="keyword">KEY</span> (<span class="string">`Sno`</span>),</span><br><span class="line">  <span class="keyword">UNIQUE</span> <span class="keyword">KEY</span> <span class="string">`Phonenumber`</span> (<span class="string">`Phonenumber`</span>)<span class="comment">/*这里UNIQUE KEY 提醒查看其他文档学习*/</span></span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="comment">/*设置CHECK约束的字段范围大，且列举全部值比较困难，比如整数或者某一区间,那就只能使用触发器来代替约束实现数据的有效性了*/</span></span><br><span class="line">DELIMITER $</span><br><span class="line"><span class="keyword">create</span> <span class="keyword">trigger</span> studentcheck <span class="keyword">before</span> <span class="keyword">insert</span> <span class="keyword">on</span> Student <span class="keyword">for</span> <span class="keyword">each</span> <span class="keyword">row</span></span><br><span class="line"><span class="keyword">begin</span></span><br><span class="line">	<span class="keyword">if</span> (new.Age&lt;<span class="number">15</span> <span class="keyword">or</span> new.Age&gt;<span class="number">30</span>) <span class="keyword">then</span></span><br><span class="line">		<span class="keyword">set</span> new.Age=<span class="number">20</span>;</span><br><span class="line">	<span class="keyword">end</span> <span class="keyword">if</span>;</span><br><span class="line"><span class="keyword">end</span> $</span><br><span class="line">DELIMITER ;</span><br><span class="line"></span><br><span class="line"><span class="keyword">create</span> <span class="keyword">trigger</span> age <span class="keyword">before</span> <span class="keyword">insert</span> <span class="keyword">on</span> ploy <span class="keyword">for</span> <span class="keyword">each</span> <span class="keyword">row</span></span><br><span class="line"><span class="keyword">begin</span> </span><br><span class="line">    <span class="keyword">if</span> (new.age &gt; <span class="number">60</span>) <span class="keyword">then</span>  </span><br><span class="line">        <span class="keyword">delete</span> <span class="keyword">from</span> ploy <span class="keyword">where</span> age=new.age;    </span><br><span class="line">    <span class="keyword">end</span> <span class="keyword">if</span>;</span><br><span class="line"><span class="keyword">end</span>;</span><br></pre></td></tr></table></figure>

<p>&emsp;&emsp;【2】元组上约束条件<br>&emsp;&emsp;&emsp;&emsp;<code>CREATE TABLE Student(SNO CHAR(9),SEX CHAR(2),CHECK(SEX=&#39;女&#39;, OR SNAME NOT LIKE &#39;Ms.%&#39;));</code></p>
<h4 id="完整性约束命名子句"><a href="#完整性约束命名子句" class="headerlink" title="完整性约束命名子句"></a>完整性约束命名子句</h4><p><code>CONSTRAINT &lt;完整性约束条件名&gt; &lt;完整性约束条件&gt;</code></p>
<p>&emsp;&emsp;【1】  </p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> Student(</span><br><span class="line">SNO <span class="built_in">NUMERIC</span>(<span class="number">6</span>)</span><br><span class="line">	<span class="keyword">CONSTRAINT</span> C1 <span class="keyword">CHECK</span> (SNO <span class="keyword">BETWEEN</span> <span class="number">90000</span> <span class="keyword">AND</span> <span class="number">99999</span>),</span><br><span class="line">SNAME <span class="built_in">CHAR</span>(<span class="number">20</span>)</span><br><span class="line">	<span class="keyword">CONSTRAINT</span> C2 <span class="keyword">CHECK</span> <span class="keyword">NOT</span> <span class="literal">NULL</span>,</span><br><span class="line">	<span class="keyword">CONSTRAINT</span> StudentKey PRIMARY <span class="keyword">KEY</span>(SNO)</span><br><span class="line">);</span><br></pre></td></tr></table></figure>

<p>&emsp;&emsp;【2】教师表  </p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> TEACHER(</span><br><span class="line">ENO <span class="built_in">NUMERIC</span>(<span class="number">4</span>) PRIMARY <span class="keyword">KEY</span>,</span><br><span class="line">ENAME <span class="built_in">CHAR</span>(<span class="number">10</span>),</span><br><span class="line">JOB <span class="built_in">CHAR</span>(<span class="number">8</span>),</span><br><span class="line">SAL <span class="built_in">NUMERIC</span>(<span class="number">7</span>,<span class="number">2</span>),   <span class="comment">/*工资*/</span></span><br><span class="line">DEDUCT <span class="built_in">NUMERIC</span>(<span class="number">7</span>,<span class="number">2</span>),   <span class="comment">/*扣除项*/</span></span><br><span class="line"><span class="keyword">CONSTRAINT</span> C1 <span class="keyword">CHECK</span> (SAL+DEDUCT&gt;=<span class="number">3000</span>)   <span class="comment">/*应发工资不低于3000*/</span></span><br><span class="line">);</span><br></pre></td></tr></table></figure>

<p>ALTER TABLE 修改表中完整性限制</p>
<p>&emsp;&emsp;【3】<font color=red>去掉</font>【1】中姓名非空限制<br>&emsp;&emsp;&emsp;&emsp;<code>ALTER TABLE Student DROP CONSTRAINT C2</code></p>
<p><font color=red>修改</font>约束条件，现删除原来的约束条件，再增加新约束条件</p>
<p>&emsp;&emsp;【4】修改【1】中学号范围900000~999999  </p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> Student</span><br><span class="line">	<span class="keyword">DROP</span> <span class="keyword">CONSTRAINT</span> C1;</span><br><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> Student</span><br><span class="line">	<span class="keyword">ADD</span> <span class="keyword">CONSTRAINT</span> C1 <span class="keyword">CHECK</span> (SNO <span class="keyword">BETWEEN</span> <span class="number">900000</span> <span class="keyword">AND</span> <span class="number">999999</span>);</span><br></pre></td></tr></table></figure>

<h3 id="用户相关"><a href="#用户相关" class="headerlink" title="用户相关"></a>用户相关</h3><h4 id="创建-无密码的账户"><a href="#创建-无密码的账户" class="headerlink" title="创建 无密码的账户"></a>创建 无密码的账户</h4><p>因为之前安装的过程中默认要创建一个账户，名为 root  的，自设密码，但是此账户权限过大（至少对我这个初学者来说），还是设置一个普通账户比较好，设置成无密码的</p>
<p><code>CREATE USER &#39;rootenv&#39;@&#39;localhost&#39; IDENTIFIED BY &#39;password&#39;;</code>     </p>
<p><code>rootenv</code> - 你将创建的用户名<br><code>localhost</code> - 指定该用户在哪个主机上可以登陆，本地用户可用localhost, 如果想让该用户可以从任意远程主机登陆,可以使用通配符%<br><code>password</code> - 该用户的登陆密码,密码可以为空,如果为空则该用户可以不需要密码登陆服务器</p>
<h4 id="更改用户密码"><a href="#更改用户密码" class="headerlink" title="更改用户密码"></a>更改用户密码</h4><p><code>SET PASSWORD FOR &#39;username&#39;@&#39;host&#39; = PASSWORD(&#39;newpassword&#39;)</code></p>
<p>如果是当前登陆用户用  <code>SET PASSWORD = PASSWORD(&quot;newpassword&quot;);</code></p>
<h4 id="授权"><a href="#授权" class="headerlink" title="授权"></a>授权</h4><p><code>GRANT privileges ON databasename.tablename TO &#39;username&#39;@&#39;host&#39;</code></p>
<p>privileges - 用户的操作权限,如SELECT , INSERT , UPDATE 等(详细列表见该文最后面).如果要授予所的权限则使用ALL.   databasename - 数据库名<br>tablename-表名,如果要授予该用户对所有数据库和表的相应操作权限则可用*表示, 如*.*.</p>
<p><code>GRANT ALL ON *.* TO &#39;rootenv&#39;@&#39;localhost&#39;;</code></p>
<p>查看都有什么权限    <code>SHOW GRANTS FOR &#39;username&#39;@&#39;%&#39;</code></p>
<p>测试时 <code>grant create,select,input,update,drop on message.* to &#39;rootenv&#39;@&#39;localhost&#39;;</code> 报错</p>
<p>分开grant  成功   show 一下  <code>GRANT SELECT, INSERT, UPDATE, CREATE, DROP ON</code>message<code>.* TO &#39;rootenv&#39;@&#39;localhost&#39;</code>  </p>
<h4 id="撤销用户权限"><a href="#撤销用户权限" class="headerlink" title="撤销用户权限"></a>撤销用户权限</h4><p><code>REVOKE privilege ON databasename.tablename FROM &#39;username&#39;@&#39;host&#39;;</code></p>
<h4 id="删除用户"><a href="#删除用户" class="headerlink" title="删除用户"></a>删除用户</h4><p><code>DROP USER &#39;username&#39;@&#39;host&#39;;</code></p>
<h2 id="推荐阅读"><a href="#推荐阅读" class="headerlink" title="推荐阅读"></a>推荐阅读</h2><p><a href="https://juejin.im/post/5d6faf8f6fb9a06b0b1c9535" target="_blank" rel="noopener">一千行MySQL命令</a></p>
<p>范式、函数依赖那一部分就不写了，抛个不错的链接<br><a href="https://www.cnblogs.com/langdashu/p/5924082.html" target="_blank" rel="noopener">MySQL 关系型数据库的设计范式 1NF 2NF 3NF BCNF</a></p>
<p><a href="https://www.cnblogs.com/igoodful/p/10876505.html" target="_blank" rel="noopener">数据库冗余是否必要</a></p>
<p><a href="https://blog.csdn.net/iamczb/article/details/43112689" target="_blank" rel="noopener">MySQL 中自增字段（AUTO_INCREMENT)的一些常识</a></p>
<p><a href="https://www.cnblogs.com/RayWang/p/9264390.html" target="_blank" rel="noopener">详记MySQL问题大全集</a></p>
<p><a href="https://dev.mysql.com/downloads/" target="_blank" rel="noopener">MySQL Community Downloads</a></p>
<p><a href="https://www.cnblogs.com/phpper/p/7587031.html" target="_blank" rel="noopener">MySQL 触发器trigger 实例详解</a></p>

    </div>

    
    
    

      <footer class="post-footer">
          <div class="post-tags">
              <a href="/tags/MySQL/" rel="tag"># MySQL</a>
              <a href="/tags/sql/" rel="tag"># sql</a>
          </div>

        


        
    <div class="post-nav">
      <div class="post-nav-item"></div>
      <div class="post-nav-item">
    <a href="/2020/10/10/resume/" rel="next" title="resume.md">
      resume.md <i class="fa fa-chevron-right"></i>
    </a></div>
    </div>
      </footer>
    
  </article>
  
  
  



          </div>
          

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          Table of Contents
        </li>
        <li class="sidebar-nav-overview">
          Overview
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
          <div class="post-toc motion-element"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#SQL语句"><span class="nav-number">1.</span> <span class="nav-text">SQL语句</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#MySQL数据库"><span class="nav-number">1.1.</span> <span class="nav-text">MySQL数据库</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#基本命令行使用命令"><span class="nav-number">1.1.1.</span> <span class="nav-text">基本命令行使用命令</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#基本定义"><span class="nav-number">1.2.</span> <span class="nav-text">基本定义</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#详细案例"><span class="nav-number">1.3.</span> <span class="nav-text">详细案例</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#查询表操作"><span class="nav-number">1.3.1.</span> <span class="nav-text">查询表操作</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#查询满足条件的元组"><span class="nav-number">1.3.1.1.</span> <span class="nav-text">查询满足条件的元组</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#ORDER-BY-子句"><span class="nav-number">1.3.1.2.</span> <span class="nav-text">ORDER BY 子句</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#聚集函数"><span class="nav-number">1.3.1.3.</span> <span class="nav-text">聚集函数</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#GROUP-BY"><span class="nav-number">1.3.1.4.</span> <span class="nav-text">GROUP BY</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#连接查询（两个以上表）"><span class="nav-number">1.3.1.5.</span> <span class="nav-text">连接查询（两个以上表）</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#嵌套循环"><span class="nav-number">1.3.1.6.</span> <span class="nav-text">嵌套循环</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#集合查询"><span class="nav-number">1.3.1.7.</span> <span class="nav-text">集合查询</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#修改表操作"><span class="nav-number">1.3.2.</span> <span class="nav-text">修改表操作</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#插入数据"><span class="nav-number">1.3.2.1.</span> <span class="nav-text">插入数据</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#修改数据"><span class="nav-number">1.3.2.2.</span> <span class="nav-text">修改数据</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#删除数据"><span class="nav-number">1.3.2.3.</span> <span class="nav-text">删除数据</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#数据库完整性约束"><span class="nav-number">1.3.3.</span> <span class="nav-text">数据库完整性约束</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#实体完整性"><span class="nav-number">1.3.3.1.</span> <span class="nav-text">实体完整性</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#参照完整性"><span class="nav-number">1.3.3.2.</span> <span class="nav-text">参照完整性</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#用户定义完整性"><span class="nav-number">1.3.3.3.</span> <span class="nav-text">用户定义完整性</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#完整性约束命名子句"><span class="nav-number">1.3.3.4.</span> <span class="nav-text">完整性约束命名子句</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#用户相关"><span class="nav-number">1.3.4.</span> <span class="nav-text">用户相关</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#创建-无密码的账户"><span class="nav-number">1.3.4.1.</span> <span class="nav-text">创建 无密码的账户</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#更改用户密码"><span class="nav-number">1.3.4.2.</span> <span class="nav-text">更改用户密码</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#授权"><span class="nav-number">1.3.4.3.</span> <span class="nav-text">授权</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#撤销用户权限"><span class="nav-number">1.3.4.4.</span> <span class="nav-text">撤销用户权限</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#删除用户"><span class="nav-number">1.3.4.5.</span> <span class="nav-text">删除用户</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#推荐阅读"><span class="nav-number">1.4.</span> <span class="nav-text">推荐阅读</span></a></li></ol></li></ol></div>
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <p class="site-author-name" itemprop="name">John Doe</p>
  <div class="site-description" itemprop="description"></div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">2</span>
          <span class="site-state-item-name">posts</span>
        </a>
      </div>
      <div class="site-state-item site-state-tags">
        <span class="site-state-item-count">2</span>
        <span class="site-state-item-name">tags</span>
      </div>
  </nav>
</div>



      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        

<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2020</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">John Doe</span>
</div>
  <div class="powered-by">Powered by <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.org/" class="theme-link" rel="noopener" target="_blank">NexT.Gemini</a>
  </div>

        








      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/pisces.js"></script>


<script src="/js/next-boot.js"></script>




  















  

  

</body>
</html>
